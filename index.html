<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Secret Decrypt</title>

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Chilanka&family=Edu+QLD+Beginner:wght@400..700&family=Mali:wght@200..700&display=swap" rel="stylesheet">

<!-- CryptoJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: linear-gradient(to right,#141e30,#243b55);
  color:white;
  font-family:'Mali', cursive;
}

.container{
  width:70%;
  height:70vh;
  display:flex;
  flex-direction:column;
  padding:20px;
}

h2{
  margin-bottom:15px;
}

/* Diary Display Box */
.result-box{
  flex:1;
  border-radius:20px;
  padding:20px;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(10px);
  background-size:cover;
  background-position:center;
  overflow:auto;
  transition: all 0.5s ease;
}

/* Text content */
.diary-content{
  white-space:pre-wrap;
  background: rgba(0,0,0,0.35);
  padding:15px;
  border-radius:15px;
  backdrop-filter: blur(8px);
}

input, textarea, button{
  margin:6px;
  padding:8px;
  border-radius:8px;
  border:none;
}

textarea{
  width:100%;
  height:120px;
  resize:none;
}

button{
  background:#ffcc70;
  cursor:pointer;
}

@media (max-width:768px){
  .container{
    width:95%;
    height:85vh;
  }
}
</style>
</head>

<body>

<div class="container">

<h2>üîì Unlock Your Secret</h2>

<textarea id="encryptedText" placeholder="Paste encrypted text from QR scanner..."></textarea>
<input type="password" id="password" placeholder="Enter Password">
<button onclick="decryptText()">Decrypt</button>

<div class="result-box" id="resultBox">
  <div class="diary-content" id="resultContent">
    Your decrypted diary will appear here...
  </div>
</div>

</div>

<script>

function decryptText(){
    const encrypted = document.getElementById("encryptedText").value;
    const password = document.getElementById("password").value;

    if(!encrypted || !password){
        alert("Enter encrypted text and password");
        return;
    }

    try{
        const bytes = CryptoJS.AES.decrypt(encrypted, password);
        const decryptedText = bytes.toString(CryptoJS.enc.Utf8);

        if(!decryptedText){
            throw "Wrong password";
        }

        const diaryObject = JSON.parse(decryptedText);

        const resultBox = document.getElementById("resultBox");
        const resultContent = document.getElementById("resultContent");

        // Restore background
        resultBox.className = "result-box " + diaryObject.background;

        // Restore font
        resultContent.style.fontFamily = diaryObject.font || "'Mali', cursive";

        // Show content
        resultContent.innerHTML = 
            diaryObject.emoji + "<br><br>" +
            diaryObject.time + "<br><br>" +
            diaryObject.text;

    }catch(error){
        alert("Wrong Password ‚ùå");
        document.getElementById("password").value = "";
        document.getElementById("resultContent").innerHTML = 
            "Your decrypted diary will appear here...";
    }
}

</script>

</body>
</html>
